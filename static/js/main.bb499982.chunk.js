(this["webpackJsonpproject-thunderball"]=this["webpackJsonpproject-thunderball"]||[]).push([[0],{113:function(t,e,a){t.exports=a.p+"static/media/windGradient.4226779c.png"},124:function(t,e,a){t.exports=a(279)},129:function(t,e,a){},130:function(t,e,a){},131:function(t,e,a){},137:function(t,e,a){},26:function(t){t.exports=JSON.parse('{"mapbox":"pk.eyJ1IjoiZnJlZHJpa2x1bmRrdmlzdCIsImEiOiJjazZobDdlbXIwM3V5M2pxOWZrNnIyOWFlIn0.6rVR9cj5Td_aAk8Vk9DiNQ","greenlytics":"Me1zJlbklkJapqtzFFyPd3Xt-qsZVok76Dhf-_N5afU"}')},279:function(t,e,a){"use strict";a.r(e);var n=a(2),r=a.n(n),i=a(108),o=a.n(i),c=(a(129),a(5)),s=(a(130),a(131),a(109)),l=(a(67),a(132),a(13)),u=a(26),d=a(111),p=a(113),f=a.n(p),m=a(61),h=a.n(m),b=function(t,e,a,n,r,i){console.log("reference: ".concat(i,", validTime: ").concat(n));for(var o=t.T.data[i][n][r],c=t.U.data[i][n][r],s=t.V.data[i][n][r],l={type:"FeatureCollection",features:[]},u=0;u<e.length-1;u++)for(var d=0;d<a.length-1;d++){var p={type:"Polygon",coordinates:[[[e[u],a[d]],[e[u+1],a[d]],[e[u+1],a[d+1]],[e[u],a[d+1]],[e[u],a[d]]]]},f={};f=d<a.length-1&&u<e.length-1?{temperature:(o[d][u]+o[d+1][u]+o[d+1][u+1]+o[d][u+1])/4,windspeed:Math.sqrt(Math.pow(c[d][u],2)+Math.pow(s[d][u],2))}:{temperature:o[d][u],windspeed:Math.sqrt(Math.pow(c[d][u],2)+Math.pow(s[d][u],2))},l.features.push({geometry:p,type:"Feature",properties:f})}return console.log(l),l},g=function(t){var e=t.polygons,a=t.DropDown,i=r.a.useRef(),o=Object(n.useState)(),p=Object(c.a)(o,2),m=(p[0],p[1],Object(n.useState)()),b=Object(c.a)(m,2),g=b[0],v=b[1],x=[13.250475,54.50044],w=[26.248053,68.840996],y=Object(n.useState)({latitude:59.33258,longitude:18.0649,zoom:5,bearing:0,pitch:0}),O=Object(c.a)(y,2),j=O[0],E=O[1];Object(n.useEffect)((function(){}),[i,j]);var k={id:"data",type:"fill",paint:{"fill-color":["interpolate",["linear"],["get","temperature"],260,"#d300fc",273,"#03f4fc",300,"#fc0703"],"fill-opacity":.5}},D={id:"data",type:"fill",paint:{"fill-color":["interpolate",["linear"],["get","windspeed"],0,"#44cdfc",10,"#000c7a"],"fill-opacity":.3}},T=Object(n.useState)(h.a),S=Object(c.a)(T,2),M=S[0],N=S[1],A=Object(n.useState)(k),I=Object(c.a)(A,2),C=I[0],_=I[1],H={width:40,height:40,borderRadius:10,fontSize:20};return r.a.createElement(l.g,Object.assign({},j,{width:"100wv",height:"85vh",onViewportChange:function(t){t.longitude>w[0]&&(t.longitude=w[0]),t.longitude<x[0]&&(t.longitude=x[0]),t.latitude>w[1]&&(t.latitude=w[1]),t.latitude<x[1]&&(t.latitude=x[1]),E(t)},mapboxApiAccessToken:u.mapbox,onHover:function(t){var e,a=null;t&&t.lngLat&&t.features&&t.features[0]&&(e=t.features[0],a={lngLat:t.lngLat,info:e.properties},v(a))},interactiveLayerIds:["data"],ref:i,minZoom:5}),e&&r.a.createElement(l.f,{type:"geojson",data:e},r.a.createElement(l.c,C)),function(){if(g)return r.a.createElement(l.e,{longitude:g.lngLat[0],latitude:g.lngLat[1],closeButton:!1},r.a.createElement("div",{className:"weather-info"},"Temperature: ",Math.round(10*(g.info.temperature-273))/10," \xb0C"),r.a.createElement("div",{className:"weather-info"},"Wind speed: ",Math.round(g.info.windspeed)," m/s"))}(),r.a.createElement("div",{style:{position:"absolute",right:"0"}},r.a.createElement(l.d,null),r.a.createElement(l.b,{positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0}),r.a.createElement(d.a,{mapRef:i,onViewportChange:function(t){return E(Object(s.a)({},t,{},{transitionDuration:1e3}))},mapboxApiAccessToken:u.mapbox,position:"top-left"})),r.a.createElement("div",{className:"dropdownDiv"},a),r.a.createElement("div",{style:{position:"absolute",display:"flex",flexDirection:"column",right:0,top:"20%"}},r.a.createElement("button",{style:H,onClick:function(){_(k)},onClickCapture:function(){N(h.a)}},"\ud83c\udf1e"),r.a.createElement("button",{style:H,onClick:function(){_(D)},onClickCapture:function(){N(f.a)}},"\ud83d\udca8")),r.a.createElement("div",{style:{position:"absolute",display:"flex",bottom:20,right:0}},r.a.createElement("img",{width:"50px",height:"338px",src:M,alt:"Gradient"})))},v=a(28),x=a.n(v),w=a(62),y=function(){var t=Object(w.a)(x.a.mark((function t(e){var a,n;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.ok){t.next=2;break}return t.abrupt("return",e);case 2:return t.prev=2,t.next=5,e.json();case 5:throw a=t.sent,n={message:a.message},a.errors&&(n.errors=a.errors),n;case 11:throw t.prev=11,t.t0=t.catch(2),t.t0;case 14:case"end":return t.stop()}}),t,null,[[2,11]])})));return function(e){return t.apply(this,arguments)}}(),O=function(t){return 204===t.status?null:t.json()},j=function(){var t=Object(n.useState)(!1),e=Object(c.a)(t,2),a=e[0],r=e[1],i=Object(n.useState)(null),o=Object(c.a)(i,2),s=o[0],l=o[1],u=Object(n.useState)(null),d=Object(c.a)(u,2),p=d[0],f=d[1],m=Object(n.useState)(null),h=Object(c.a)(m,2),b=h[0],g=h[1];return[function(){var t=Object(w.a)(x.a.mark((function t(e){var a,n,i,o,c=arguments;return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=c.length>1&&void 0!==c[1]?c[1]:{},t.prev=1,r(!0),t.next=5,fetch(e,a);case 5:return n=t.sent,t.next=8,y(n);case 8:return i=t.sent,t.next=11,O(i);case 11:o=t.sent,g(n.status),l(o),l(o),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(1),f(t.t0);case 20:return t.prev=20,r(!1),t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[1,17,20,23]])})));return function(e){return t.apply(this,arguments)}}(),a,s,p,b]},E=function(t,e,a){for(var n=[],r=t;r<=e;r+=a)n.push(r);return n},k=a(7),D=(a(137),a(138),a(139),a(140),function(t){t.dataItems;for(var e=t.start,a=t.end,r=t.refTimes,i=t.updateRefTime,o=[],c=0,s=new Date(Date.parse(e)),l=new Date(Date.parse(a)),u=new Date(Date.parse(e));u<l;){var d=new Date(u),p=new Date(u).setHours(u.getHours()+2);o.push({lane:0,id:c,start:d,end:p,refTime:r[c]}),c+=1,u.setHours(u.getHours()+3)}console.log(o);k.e(".chart").remove();var f=960-40-40,m=500-250-250,h=k.c().domain([s,l]).range([0,f]),b=k.a().scale(h).tickFormat(k.f("%H:%M")),g=Object(n.useRef)(),v=Date.now(),x=(k.d(g.current),[20,15,15,150]),w=k.c().domain([s,l]).range([0,960]),y=k.b().range([0,960]),O=(k.b().domain([0,1]).range([0,1]),k.b().domain([0,1]).range([0,1])),j=k.d("div#container").append("svg").attr("preserveAspectRatio","xMinYMin meet").attr("viewBox","0 0 1200 300").classed("svg-content",!0).attr("class","chart").append("g").attr("transform","translate("+x[3]+","+x[0]+")").attr("width",960).attr("height",1).attr("class","timeline");j.append("g").selectAll(".laneLines").data(o).enter().append("line").attr("x1",v).attr("x2",v).attr("y1",0).attr("y2",1).attr("stroke","black"),j.append("g").selectAll(".laneText").data(["Model runs"]).enter().append("text").text((function(t){return t})).attr("x",-x[1]).attr("y",(function(t,e){return O(e+.5)})).attr("dy",".5ex").attr("text-anchor","end").attr("class","laneText");var E,D=j.append("g").attr("clip-path","url(#clip)");return j.append("g").selectAll("miniItems").data(o).enter().append("rect").attr("class",(function(t){return"miniItem"+t.lane})).attr("x",(function(t){return w(t.start)})).attr("y",(function(t){return O(t.lane+.5)-5})).attr("width",(function(t){return w(t.end)-w(t.start)})).attr("height",10).style("fill",(function(t){return t.refTime?"#18515E":"#707070"})).on("click",(function(t){E?(k.d(E).style("fill","#18515E"),E=this,k.d(E).style("fill","#b1a7b6")):(E=this,k.d(E).style("fill","#b1a7b6")),i(t.refTime)})),j.append("g").attr("class","x axis").attr("transform","translate(0,"+m+")").call(b.ticks(24)),j.append("g").selectAll("rect").attr("y",1).attr("height",0),function(){var t,e;o.filter((function(t){return t.start<void 0&&t.end>void 0}));y.domain([void 0,void 0]),(t=D.selectAll("rect").data(o,(function(t){return t.id})).attr("id",(function(t){return t.start})).attr("x",(function(t){return w(t.start)})).attr("width",(function(t){return w(t.end)-w(t.start)}))).enter().append("rect").attr("class",(function(t){return"miniItem"+t.lane})).attr("x",(function(t){return w(t.start)})).attr("width",(function(t){return w(t.end)-w(t.start)})),t.exit().remove(),(e=D.selectAll("text").data(o,(function(t){return t.id})).attr("x",(function(t){return y(Math.max(t.start,void 0)+2)}))).enter().append("text").text((function(t){return t.id})).attr("x",(function(t){return y(Math.max(t.start,void 0))})).attr("text-anchor","start"),e.exit().remove()}(),null}),T="2020-03-06T00:00:00.000000000",S={lon:37,lat:70},M={lon:2,lat:52},N={lon:E(M.lon,S.lon,.5),lat:E(M.lat,S.lat,.5)};var A=function(){var t=j(),e=Object(c.a)(t,4),a=e[0],i=e[1],o=e[2],s=e[3],l=r.a.useState(),d=Object(c.a)(l,2),p=d[0],f=d[1],m=r.a.useState(),h=Object(c.a)(m,2),v=h[0],x=h[1],w=r.a.useState(T),y=Object(c.a)(w,2),O=y[0],E=y[1],k=r.a.useState(0),S=Object(c.a)(k,2),M=S[0],A=S[1],I=r.a.useState(),C=Object(c.a)(I,2),_=C[0],H=C[1];return Object(n.useEffect)((function(){var t={model:"DWD_ICON-EU",start_date:"2020-03-06 00",end_date:"2020-03-07 00",freq:"3H",coords:{latitude:N.lat,longitude:N.lon,height:[60]},variables:["T","U","V"]},e={headers:{Authorization:u.greenlytics}};a("https://api.greenlytics.io/weather/v1/get_nwp?query_params="+JSON.stringify(t),e)}),[]),Object(n.useEffect)((function(){i||null===o||null!==s||(x(o.coords.reference_time.data),H(o.coords.valid_time.data),f(b(o.data_vars,N.lon,N.lat,M,0,o.coords.reference_time.data.indexOf(O))))}),[o,i,s]),Object(n.useEffect)((function(){o&&f(b(o.data_vars,N.lon,N.lat,M,0,v.indexOf(O)))}),[M]),Object(n.useEffect)((function(){o&&f(b(o.data_vars,N.lon,N.lat,M,0,v.indexOf(O)))}),[O]),r.a.createElement("div",{className:"App"},r.a.createElement("div",{id:"container",className:"svg-container"}),p&&_?r.a.createElement("div",null,r.a.createElement(D,{dataItems:[{start:"2019-08-15 10",end:"2019-08-15 12"},{start:"2019-08-15 14",end:"2019-08-15 15"}],start:T,end:"2020-03-07T00:00:00.000000000",refTimes:v,updateRefTime:E}),r.a.createElement(g,{polygons:p,DropDown:function(t){return r.a.createElement("select",{onChange:function(t){return A(t.target.value)}},t.map((function(t){return r.a.createElement("option",{value:t,key:t},function(t){var e=new Date(Date.parse(T));return e.setHours(e.getHours()+t),e}(t).toLocaleTimeString())})))}(_)})):r.a.createElement("div",{className:"center-content"},r.a.createElement("div",{className:"sk-folding-cube"},r.a.createElement("div",{className:"sk-cube1 sk-cube"}),r.a.createElement("div",{className:"sk-cube2 sk-cube"}),r.a.createElement("div",{className:"sk-cube4 sk-cube"}),r.a.createElement("div",{className:"sk-cube3 sk-cube"}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(A,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))},61:function(t,e,a){t.exports=a.p+"static/media/tempGradient.b83629ab.png"}},[[124,1,2]]]);
//# sourceMappingURL=main.bb499982.chunk.js.map